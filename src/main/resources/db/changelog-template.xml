<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

   <!-- SECTION: exampleEntity -->
   <changeSet id="${prefix}-create-example-entity-v1" author="example-data-qbit">
      <createTable tableName="${prefix}_example_entity">
         <column name="id" type="INT" autoIncrement="true">
            <constraints primaryKey="true"/>
         </column>
         <column name="code" type="VARCHAR(50)">
            <constraints nullable="false" unique="true"/>
         </column>
         <column name="name" type="VARCHAR(100)">
            <constraints nullable="false"/>
         </column>
         <column name="description" type="VARCHAR(500)"/>
         <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
         <column name="create_date" type="TIMESTAMP"/>
         <column name="modify_date" type="TIMESTAMP"/>
      </createTable>
      <createIndex tableName="${prefix}_example_entity" indexName="${prefix}_example_entity_code_idx">
         <column name="code"/>
      </createIndex>
   </changeSet>
   <!-- END SECTION: exampleEntity -->

   <!-- SECTION: exampleChildEntity -->
   <changeSet id="${prefix}-create-example-child-entity-v1" author="example-data-qbit">
      <createTable tableName="${prefix}_example_child_entity">
         <column name="id" type="INT" autoIncrement="true">
            <constraints primaryKey="true"/>
         </column>
         <column name="example_entity_id" type="INT">
            <constraints nullable="false"/>
         </column>
         <column name="code" type="VARCHAR(50)">
            <constraints nullable="false"/>
         </column>
         <column name="name" type="VARCHAR(100)">
            <constraints nullable="false"/>
         </column>
         <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
         <column name="create_date" type="TIMESTAMP"/>
         <column name="modify_date" type="TIMESTAMP"/>
      </createTable>
      <addForeignKeyConstraint
         baseTableName="${prefix}_example_child_entity"
         baseColumnNames="example_entity_id"
         referencedTableName="${prefix}_example_entity"
         referencedColumnNames="id"
         constraintName="${prefix}_fk_child_to_parent"/>
      <createIndex tableName="${prefix}_example_child_entity" indexName="${prefix}_example_child_entity_parent_idx">
         <column name="example_entity_id"/>
      </createIndex>
   </changeSet>
   <!-- END SECTION: exampleChildEntity -->

</databaseChangeLog>
